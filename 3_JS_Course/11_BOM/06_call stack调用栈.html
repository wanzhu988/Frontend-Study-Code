<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <script>
            /* 
                事件循环（event loop）
                    - 函数在每次执行时，都会产生一个执行环境
                    - 执行环境负责存储函数执行时产生的一切数据
                    - 问题：函数的执行环境要存储到哪里呢？
                        - 函数的执行环境存储到了一个叫做调用栈的地方
                        - 栈，是一种数据结构，特点 后进先出
                    
                    调用栈（call stack）
                        - 调用栈负责存储函数的执行环境
                        - 当一个函数被调用时，它的执行环境会作为一个栈帧插入到调用栈的栈顶，函数执行完毕其栈帧会自动从栈中弹出
                    调用栈是一种数据结构，用于存储函数调用的记录。每当在 JavaScript 中调用一个函数时，会为那次调用创建一个新的记录（称为栈帧），
                    这个栈帧包含了函数的参数、局部变量等信息。栈的特性是“后进先出”（LIFO），这意味着最后进入栈的函数会被首先执行完成。
            */

            function fn() {
                let a = 10
                let b = 20
                function fn2() {
                    console.log("fn2")
                }
                fn2()
                console.log("fn~")
            }
            fn()
            console.log(1111)
            // 1.当 fn() 在脚本的最后被调用时，一个栈帧被创建并推入调用栈的顶部。
            // 2.函数 fn2 在 fn 内部被调用：
                // 在 fn 的执行过程中，它内部定义的 fn2() 被调用。
                // fn2() 的栈帧被推入调用栈顶部，位于 fn 的栈帧之上。
                // fn2() 执行完成后，它的栈帧从调用栈中弹出，控制权返回到 fn。
            // 3.fn 的余下部分执行完成：
                // fn2() 完成后，fn 中余下的代码（即 console.log("fn~")）继续执行。
                // 当 fn 执行完毕后，其栈帧也从调用栈中弹出。
                // 全局代码执行：一旦 fn 完全执行完毕并从调用栈中移除，全局环境中的 console.log(1111) 执行。
            
            //事件循环是 JavaScript 运行时环境中的一个核心概念，用于处理异步事件。事件循环监控调用栈和消息队列（任务队列）。
            //如果调用栈为空，事件循环会从队列中取出第一个事件，并将相关的回调推入调用栈中执行。
        </script>
    </head>
    <body></body>
</html>
